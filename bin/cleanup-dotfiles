#!/bin/bash

# If this script gets sourced wait until the shell closes and then run this
if [ "$0" == "$BASH_SOURCE" ]; then
	trap ~/bin/cleanup-dotfiles EXIT
else
	# Remove all simlinks that point to the dotfiles
	cd ~
	for link in $(find . -type l -not -path './dotfiles/*'); do
		if [ ! -z "$(readlink $link | fgrep dotfiles)" ]; then
			rm -rf $link
		fi
	done

	# Remove dotfiles
	if [ ! -z "$KEEP_DOTFILES" ]; then
		rm -rf ~/dotfiles
	fi
fi
